
<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>一战到底</title>
  <style>
    .overlay {
      position:fixed;
      top: 0;
      background-color: #000;
      opacity: 0.8;
      width: 100%;
      height: 100%;
    }
    .dialogue {
      position: absolute;
      padding: 1rem 0;
      background-color:#FFFFFF ;
      border-radius: 0 0 0.3rem 0.3rem ;
      text-align: center;
    }
  </style>
</head>
<body>
<div id="app_container">
</div>
<script type="text/template" id="tpl_modal">
  <div class="overlay"></div>
  <div class="dialogue">
    <%- message %>
    <button class="submit <%= button.class %>"><%= button.text %></button>
  </div>
</script>
<script type="text/template" id="tpl_question">
  <% if(timeLimit){ %>
  剩余<spam class="timer"><%- timeLimit %></spam>秒
  <% } %>
  <div class="content"><%= content %></div>
  <div class="option_list"></div>
  <input type="submit" class="submit">
</script>
<script type="text/template" id="tpl_option_single">
  <input type='radio' id='option_<%= id %>' name='question_option'>
  <label for='option_<%= id %>'><spam><%= code %></spam> <%= content %></label>
</script>
<script type="text/template" id="tpl_option_multi">
  <input type='checkbox' id='option-<%= id %>' name='question_option'>
  <label for='option-<%= id %>'><spam><%= code %></spam> <%= content %></label>
</script>
<script type='text/template' id='tpl_quiz_panel'>
  <spam>已回答<%= count %>题</samp>
  <span>得到<%= points %>分</span>
</script>
<script type='text/template' id='tpl_welcome'>
  <%- content %>
  <% if (!_.isEmpty(infoFields) ){ %>
  <section class="info">
  <h1>请完整填写以下资料：</h1>
  <% _.each(infoFields, function(field){
    var field_key = field[0];
    var field_text = field[1];
    saved = localStorage.getItem(field_key) || ''; %>
    <input placeholder="<%= field_text %>" name="<%= field_key %>" value="<%= saved %>">
  <% }) %>
  </section>
  <% } %>
<input type="submit" class="submit" value="开始游戏">
</script>
<script type="text/template" id="tpl_too_early">
  <section class="reject">
    亲，本次活动未开始，<br />
    活动很精彩，敬请期待哦~~
  </section>
</script>
<script type="text/template" id="tpl_too_late">
  <section class="reject">
    亲，本次活动已结束，<br />
    下次要记得赶早哦~~~
  </section>
</script>
<script type="text/template" id="tpl_no_more_chance">
  <section class="reject">
    亲，您的答题次数已经用完，<br />
    下次活动再努力哦~~~
  </section>
</script>
<script type="text/template" id="tpl_rank">
  <section>
  这一局中我获得了<span class="redWords"><%=points%></span>分（总分是<%=maxPoints%>分），当前排名第<span class="redWords"><%=rank%></span>名，我的最好成绩
  是<span class="redWords"><%=bestPoints%></span>分，最好排名是第<span class="redWords"><%=bestRank%></span>名。
  </section>
</script>
<script type="text/javascript" src="/script/packed.js"></script>
<script>
var application = null;
var game_code = window.location.hash.slice(1);
var data_url_root = '/data/' + game_code + '/';
$.getJSON(data_url_root + 'config.json').then(function(data){
  application = new app.ApplicationView({game_code: game_code, config: data});
  application.startQuiz();
  // var errorView = null;
  // var used_chances = parseInt(localStorage.getItem(game_code + '_count'));
  // if (used_chances > parseInt(data.max_chances)){
  //   errorView = new app.RejectionNoMoreChanceView();
  // } else {
  //   var now = new Date();
  //   var start_at = new Date(data.start_at);
  //   var end_at = new Date(data.end_at);
  //   if(now < start_at){
  //     errorView = new app.RejectionTooEarlyView();
  //   } else if (now > end_at){
  //     errorView = new app.RejectionTooLateView();
  //   }
  // };
  // if(errorView){
  //   application.loadView(errorView);
  // } else {
  //   application.prepareQuiz();
  // }
});
</script>
</body>
</html>
